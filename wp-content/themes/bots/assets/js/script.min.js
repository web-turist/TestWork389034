const contactForm = document.querySelector('.contact-form'),
      buttonSubmitForm = document.querySelector('.form__btn'),
      buttons = document.querySelectorAll('.btn-modal'),
      checkbox = document.querySelector('.form__checkbox-input'),
      modal = document.querySelector('.form');


buttons.forEach((elem) => {
    console.log('object');
    elem.addEventListener('click', () => {
        contactForm.classList.add('contact-form_active');
    })
});

buttonSubmitForm.addEventListener('click', (event) => {
    event.preventDefault();
    if (!checkbox.checked) {
        checkbox.setCustomValidity('Упс!! Галку не поставили!');
    }

//надо подумать как вытащить url
    // const fileInput = document.querySelector('.input-img');

    // fileInput.addEventListener('change', (event) => {
    //     const file = event.target.files[0];
    //     const reader = new FileReader();

    //     reader.addEventListener('load', (event) => {
    //         const fileName = file.name;
    //         const fileURL = event.target.result;

    //         console.log(fileName);
    //         console.log(fileURL);
    //     });
    //     reader.readAsDataURL(file);
    // });


    const productName = document.querySelector('.input-name').value,
          productPrice = document.querySelector('.input-price').value,
          productDiscount = document.querySelector('.input-discount').value,
          productImg = document.querySelector('.input-img').value,
          addingDate = document.querySelector('.input-date').value,
          productSelect = document.querySelector('#uniqueness-select').value;

    const params = {'productName': productName,
                    'productPrice': productPrice,
                    'productDiscount': productDiscount,
                    'productImg':  productImg,
                    'addingDate': addingDate,
                    'productSelect': productSelect}


    // const paramsNew = [productName, productPrice, productDiscount, productImg, addingDate, productSelect];

    const url = 'http://localhost:8888/bots/wp-json/wc/v3/products';
    const wooKey = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';
    const wooKeySecret = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';

    function myAuth(key, secret) {
        let hash = btoa(key + ':' + secret);
        return 'Basic ' + hash;
    }

    let auth = myAuth(wooKey, wooKeySecret);
console.log(params);
        fetch(url, {
            method: 'POST',
            body: JSON.stringify(paramsNew),
            headers: {
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, OPTIONS',
                'Access-Control-Allow-Headers': 'Content-Type',
                'Access-Control-Allow-Headers': 'Authorization',
                'Authorization': myAuth(wooKey, wooKeySecret),
                'Content-Type': 'application/json'
            }
        }).then(
            response => {
            console.log(response);
            }
        )

     contactForm.classList.remove('contact-form_active');
});
